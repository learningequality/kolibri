name: Kolibri Build Assets for Push

on:
  push:
    branches:
    - develop
    - 'release-v**'

jobs:
  whl:
    name: Build WHL file
    uses: ./.github/workflows/build_whl.yml
  pex:
    name: Build PEX file
    needs: whl
    uses: ./.github/workflows/build_pex.yml
    with:
      whl-file-name: ${{ needs.whl.outputs.whl-file-name }}
  dmg:
    name: Build DMG file
    needs: whl
    uses: learningequality/kolibri-app/.github/workflows/build_mac.yml@main
    with:
      whl-file-name: ${{ needs.whl.outputs.whl-file-name }}
      ref: main
  deb:
    name: Build DEB file
    needs: whl
    uses: learningequality/kolibri-installer-debian/.github/workflows/build_deb.yml@master
    with:
      tar-file-name: ${{ needs.whl.outputs.tar-file-name }}
      ref: master
  exe:
    name: Build EXE file
    needs: whl
    uses: learningequality/kolibri-installer-windows/.github/workflows/build_exe.yml@develop
    with:
      whl-file-name: ${{ needs.whl.outputs.whl-file-name }}
      ref: develop
  apk:
    name: Build APK file
    needs: whl
    uses: learningequality/kolibri-installer-android/.github/workflows/build_apk.yml@develop
    with:
      tar-file-name: ${{ needs.whl.outputs.tar-file-name }}
      ref: develop
